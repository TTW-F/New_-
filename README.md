# 交互式医疗问答系统使用指南

## 快速开始

### 启动交互式问答程序

```bash
python qa_cli.py
```

程序启动后，您将看到欢迎界面和操作提示。

## 功能特性

### ✨ 核心功能

1. **智能问答**
   - 支持自然语言问题
   - 基于 GraphRAG 的知识图谱检索
   - 提供专业的医疗建议和引用来源

2. **连续对话**
   - 支持多轮对话
   - 自动维护对话上下文
   - 可查看对话历史

3. **对话管理**
   - 清空对话历史
   - 查看完整对话记录
   - 会话信息记录

    
目前仅支持简单的医疗诊断,对话模块与更多功能完善中,
未来目标:
1,对话历史持久化
2,医疗诊断逻辑参考对话历史中的关键信息
3,前端开发,用户登录注册页面,管理员后台,用户聊天页面
4,医生专属模式开发



## 使用示例

### 基本问答

```
💬 请输入您的问题: 我头痛发热，可能是什么病？

🤔 正在思考...

💡 回答:
根据您描述的症状，头痛和发热可能是感冒、流感等疾病的症状...
```

### 连续对话

```
💬 请输入您的问题: 我头痛发热，可能是什么病？
[系统回答...]

💬 请输入您的问题: 需要做什么检查？
[系统基于上下文回答...]

💬 请输入您的问题: 应该吃什么药？
[系统继续基于上下文回答...]
```

### 查看对话历史

```
💬 请输入您的问题: history

============================================================
对话历史
============================================================

[1] 用户 (2025-01-20T10:30:00):
    我头痛发热，可能是什么病？

[2] 助手 (2025-01-20T10:30:05):
    根据您描述的症状...
```

## 可用命令

| 命令 | 说明 |
|------|------|
| `help` | 显示帮助信息 |
| `history` | 查看对话历史 |
| `clear` | 清空对话历史 |
| `about` | 查看系统信息 |
| `quit` / `exit` | 退出程序 |

## 系统架构

- **GraphRAG 服务**: `graphrag_service.py`
  - 实体识别与链接
  - 子图检索
  - 上下文构建
  - LLM 生成答案

- **Neo4j 知识图谱**: 存储医疗实体和关系
- **DeepSeek LLM**: 生成专业回答

## 环境配置

确保已配置以下环境变量（`.env` 文件）：

```env
DEEPSEEK_API_KEY=your_api_key
DEEPSEEK_BASE_URL=https://api.deepseek.com
DEEPSEEK_MODEL=deepseek-chat

NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password
```

## 注意事项

1. **首次使用**: 确保 Neo4j 数据库已启动并包含医疗知识图谱数据
2. **网络连接**: 需要能够访问 DeepSeek API
3. **问题格式**: 建议使用完整的问句，包含具体的症状或疾病名称

## 故障排查

### 问题: 无法识别实体

**解决**: 尝试使用更具体的医疗术语，例如：
- ❌ "我不舒服"
- ✅ "我头痛发热"

### 问题: 响应较慢

**原因**: 
- 首次连接 Neo4j 需要时间
- LLM API 调用需要时间

**解决**: 正常现象，请耐心等待

### 问题: 找不到相关答案

**原因**: 知识图谱中可能没有相关数据

**解决**: 
- 尝试换一种问法
- 检查 Neo4j 数据库是否包含相关数据

## 技术栈

- Python 3.9+
- LangChain 0.3.x
- Neo4j
- DeepSeek API

## 开发说明

### 文件结构

```
qa_cli.py              # 交互式问答 CLI 程序
graphrag_service.py    # GraphRAG 核心服务
neo4j_service.py       # Neo4j 查询服务
```

### 扩展功能

可以通过修改 `qa_cli.py` 添加：
- 导出对话历史
- 保存对话记录到数据库
- 支持流式输出
- 多语言支持

---

**提示**: 本系统仅供学习和参考，不提供医疗诊断建议。如有医疗问题，请咨询专业医生。


